"use strict";(self.webpackChunk_genially_view_client=self.webpackChunk_genially_view_client||[]).push([[9679],{43190:(e,t,i)=>{i.d(t,{q:()=>m});var n=i(45992),d=i(17588),l=i(66264),s=i(60708),o=i(34895),r=i(25e3);const m=e=>{let{getItems:t,item:i,menuType:m,theme:u,shouldCloseWhenClickOutside:a=!1,itemSize:c,menuTheme:h}=e;const[v,g]=(0,d.useState)(t()),[p,f]=(0,d.useState)(!1),S=(0,d.useCallback)((()=>{f((e=>!e))}),[]);null===i||void 0===i||i.on(l.q.Message,(e=>{e===s.m.Entering&&(g(t()),f(!1))}));const T=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const i=(0,d.useRef)(null);return(0,d.useEffect)((()=>{const n=t=>{i.current&&!i.current.contains(t.target)&&e(t)};return document.addEventListener("mouseup",n,t),document.addEventListener("touchend",n,t),()=>{document.removeEventListener("mouseup",n,t),document.removeEventListener("touchend",n,t)}}),[i,e,t]),i}((0,d.useCallback)((()=>{a&&p&&f(!1)}),[p,a]),!0);(0,d.useEffect)((()=>{g(t())}),[t]);const y=(0,o.CO)(m);return(0,r.T)({theme:u,children:(0,n.jsx)(y,{items:v,onToggleClick:S,opened:p,ref:T,theme:u,itemSize:c,menuTheme:h})})}},99679:(e,t,i)=>{i.r(t),i.d(t,{geniallyMenuEditorScript:()=>I});var n=i(45992),d=i(17588),l=i(57277),s=i(42511),o=i(43190),r=i(49443),m=i(34895),u=i(9380),a=i(15536),c=i(91910),h=i(45994),v=i(25e3);const g=(e,t,i,d)=>{const{width:l}=((e,t,i)=>{const d=(0,h.d)((0,v.T)({theme:t,children:(0,n.jsx)(s.W,{children:(0,n.jsx)(c.I,{items:e,menuTheme:i})})}));return{width:d.width+2*a.I,height:d.height+2*a.I}})(t,i,d);return{itemsAreOverflowing:l>e,minimalWidth:l}};var p,f=i(47556);!function(e){e[e.MD=380]="MD"}(p||(p={}));const S=e=>e<=p.MD?u.L.Hamburger:u.L.Horizontal;var T=i(933);const y=new class{constructor(){this.state={}}getState(e){return this.state[e]}setState(e,t){this.state[e]=Object.assign(Object.assign({},this.state[e]),t)}removeState(e){delete this.state[e]}initializeState(e,t){this.state[e]=t}},w=e=>{var t,i;e.item&&e.item.exists&&y.setState(e.item.id,{menuType:e.getConfig().menuType,size:{width:null===(t=e.item)||void 0===t?void 0:t.width,height:null===(i=e.item)||void 0===i?void 0:i.height}})},C=(e,t)=>{let{item:i,editor:n,script:d}=e;if(!i)return;const l=y.getState(i.id);if(!l)return;const s=S(i.width),o=S(l.size.width),a=s!==o,c=i.width!==l.size.width,h=()=>g(i.width,(0,T.N)(d.getConfig().menuItems),n.theme,t),v=e=>{((e,t,i,n)=>{e!==t.getConfig().menuType&&t.mutateConfig((t=>{t.menuType=e}));const d=(0,m.FB)(e);i.thumbnail!==d.dark&&i.thumbnail!==d.light&&(i.thumbnail=n===r.N.Dark?d.dark:d.light)})(e,d,i,t)};if(a){const{itemsAreOverflowing:e}=h();v(e?u.L.Hamburger:u.L.Horizontal)}else c&&(()=>{const{itemsAreOverflowing:e}=h();v(e?u.L.Hamburger:s)})();w(d)},x=(e,t)=>{var i;if(!e.item||!e.item.exists)return;const{item:n,getConfig:d}=e,l=n,{menuType:s,menuTheme:o}=d(),r=y.getState(e.item.id);if((e=>{let{currentWidth:t,previousWidth:i,currentMenuType:n,previousMenuType:d}=e;return t===i&&n!==d})({currentWidth:l.width,previousWidth:null===r||void 0===r?void 0:r.size.width,currentMenuType:s,previousMenuType:null===r||void 0===r?void 0:r.menuType})){if(s===u.L.Horizontal){const{minimalWidth:d}=g(n.width,(0,T.N)(e.getConfig().menuItems),t.theme,o),r=(e=>{switch(e){case u.L.Horizontal:return{minWidth:p.MD,maxWidth:void 0};case u.L.Hamburger:return{minWidth:f.N_.width,maxWidth:p.MD};default:return{minWidth:void 0,maxWidth:void 0}}})(s),m=l.parentSlide.size.width-24,a=Math.min(d,m),c=Math.max(null!==(i=r.minWidth)&&void 0!==i?i:0,a);l.setSize(c,f.cE.height),l.setPosition((l.parentSlide.size.width-c)/2,l.y)}s===u.L.Hamburger&&l.setSize(f.N_.width,f.N_.height)}y.setState(e.item.id,{menuType:s,size:{width:null===l||void 0===l?void 0:l.width,height:null===l||void 0===l?void 0:l.height}})};const D=e=>{let{editor:t,script:i}=e;var l,r;const{theme:m}=t,{menuItems:u,menuType:a,menuTheme:c}=i.getConfig(),{item:h}=i,v=(0,s.C)(),g=(e=>e?{width:e.width}:{})(h);(0,d.useEffect)((()=>{C({item:h,editor:t,script:i},c)}),[t,h,c,g,i]);const p={width:null!==(l=null===h||void 0===h?void 0:h.width)&&void 0!==l?l:0,height:null!==(r=null===h||void 0===h?void 0:h.height)&&void 0!==r?r:0};return t.on("sidebarOpened",(()=>{v.enableSelection(!0)})),(0,n.jsx)(o.q,{getItems:()=>(0,T.N)(u),menuType:a,theme:m,itemSize:p,menuTheme:c})},I=e=>{let{script:t,editor:i}=e;i.on("slideCreated",(e=>{let{slide:i}=e;((e,t)=>{!1===e.getConfig().slidesToDisplay.allSlidesSelected&&e.item.excludedSlidesIds.push(t.id)})(t,i)})),i.on("slideDeleted",(e=>{let{slide:n}=e;((e,t)=>{1===e.getSlides().length&&t.mutateConfig((e=>{e.slidesToDisplay.allSlidesSelected=!0,e.slidesToDisplay.selectedSlides=[]}))})(i,t),((e,t)=>{const{allSlidesSelected:i,selectedSlides:n}=e.getConfig().slidesToDisplay;if(!i)if(null===n||void 0===n?void 0:n.includes(t.id))e.mutateConfig((e=>{e.slidesToDisplay.selectedSlides=e.slidesToDisplay.selectedSlides.filter((e=>e!==t.id))}));else{const i=e.item;i.excludedSlidesIds=i.excludedSlidesIds.filter((e=>e!==t.id))}})(t,n)})),t.once("configChange",(()=>{w(t),(e=>{let{editor:t,script:i}=e;0===i.getConfig().slidesToDisplay.selectedSlides.length&&i.mutateConfig((e=>{e.slidesToDisplay.selectedSlides=t.getSlides().map((e=>e.id))}))})({editor:i,script:t})})),t.on("configChange",(e=>{let{config:n,prevConfig:d}=e;((e,t,i,n)=>{e.item&&e.item.exists&&(function(e){const{item:t}=e,i=t;i.isTransversal||(i.isTransversal=!0)}(e),function(e,t,i){const n=i.slidesToDisplay.selectedSlides.filter((e=>t.getSlides().find((t=>t.id===e))));n.length!==i.slidesToDisplay.selectedSlides.length&&e.mutateConfig((e=>{e.slidesToDisplay.selectedSlides=n}))}(e,t,i),function(e,t,i,n){const{item:d}=e,l=d;(i.slidesToDisplay.allSlidesSelected!==(null===n||void 0===n?void 0:n.slidesToDisplay.allSlidesSelected)||i.slidesToDisplay.selectedSlides!==(null===n||void 0===n?void 0:n.slidesToDisplay.selectedSlides))&&(l.excludedSlidesIds=function(e,t){if(e.slidesToDisplay.allSlidesSelected)return[];const i=t.getSlides(),n=e.slidesToDisplay.selectedSlides||[];return i.filter((e=>!n.includes(e.id))).map((e=>e.id))}(i,t),e.mutateConfig((e=>{e.slidesToDisplay.allSlidesSelected&&(e.slidesToDisplay.selectedSlides=[])})))}(e,t,i,n))})(t,i,n,d),(e=>{if(!e.item||!e.item.exists)return;const{item:t,getConfig:i}=e,n=t,{menuType:d,menuTheme:l}=i(),s=y.getState(e.item.id),o=(0,m.FB)(d);(null===s||void 0===s?void 0:s.menuType)===d&&(null===s||void 0===s?void 0:s.menuTheme)===l||(n.thumbnail=l===r.N.Dark?o.dark:o.light)})(t),x(t,i);const{item:l}=t;l&&"showOverflow"in l&&!l.showOverflow&&(l.showOverflow=!0)})),t.on("dispose",(()=>{var e,i,n;(null===(e=null===t||void 0===t?void 0:t.item)||void 0===e?void 0:e.id)&&(null===(n=null===(i=y.getState(t.item.id))||void 0===i?void 0:i.disposer)||void 0===n||n.call(i),y.removeState(t.item.id))})),(0,l.x)({getTargetNodeItem:()=>t.item,renderApp:()=>(0,n.jsx)(s.W,{isInEditor:!0,children:(0,n.jsx)(D,{editor:i,script:t})}),nodePrefix:"menu"})({script:t,editor:i})}},933:(e,t,i)=>{i.d(t,{N:()=>s,e:()=>r});var n=i(48237),d=i(22077);const l=e=>""===e?(0,d.A)("__new.view.widget.menu.sidebar.emptyTitlePlaceholder"):e,s=e=>e.map(((e,t)=>{var i;const d=(null===(i=e.menuItemAction.action)||void 0===i?void 0:i.type)===n.L.GoToSlide;return{text:l(e.menuItemName),key:t,onClick:()=>{},isLink:d,isActive:!1,isAllowed:d,altText:e.altText}})),o={active:!1,allowed:!1},r=(e,t)=>e.map(((e,i)=>{var d,s;const r=!!(null===(d=e.menuItemAction)||void 0===d?void 0:d.data)&&(null===(m=e.menuItemAction.data)||void 0===m?void 0:m.type)===n.L.GoToSlide;var m;const{active:u,allowed:a}=r&&(null===(s=e.menuItemAction)||void 0===s?void 0:s.data)?t.getGoToSlideState(e.menuItemAction.data):o;return{text:l(e.menuItemName),key:i,onClick:()=>{var t;return null===(t=e.menuItemAction)||void 0===t?void 0:t.run()},isLink:r,isActive:u,isAllowed:a,altText:e.altText}}))},57277:(e,t,i)=>{i.d(t,{x:()=>d});var n=i(70377);function d(e){let{getTargetNodeItem:t,renderApp:i,nodePrefix:d}=e;return e=>{let{script:l,editor:s}=e,o=null;function r(e){o&&(n.unmountComponentAtNode(o),o=null),e&&"innerHtml"in e&&(e.innerHtml='<div class="card-iframe"><div style="width: 100%; height: 100%; background: #FF0000; color: #FFFFFF;">Deleted</div><script><\/script></div>')}function m(){o&&n.render(i(),o)}function u(){const e=t(l.getConfig());if(!e)return;const i=`${d}-${e.id}`;"innerHtml"in e&&(e.innerHtml=`<div class="card-iframe"><div id="${i}" class="genially-widget-app" style="width: 100%; height: 100%;"></div></div>`),requestAnimationFrame((()=>{o="idOfFreeNode"in e?document.getElementById(e.idOfFreeNode):document.getElementById(i),m()}))}l.on("configChange",(e=>{let{config:i,prevConfig:n}=e;const d=t(i),l=n?t(n):void 0;l&&l!==d&&r(l),d&&(d!==l?u():m())})),l.on("dispose",(()=>{r(t(l.getConfig()))})),s.on("itemMount",(e=>{let{item:t}=e;t===l.item&&u()})),s.on("itemUnmount",(e=>{let{item:t}=e;t===l.item&&r()}))}}}}]);
//# sourceMappingURL=https://s3-static-genially.genially.com/view/static/js/9679.ac4be980.chunk.js.map